{\rtf1\ansi\ansicpg1252\cocoartf2822
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\fs24 \cf0 <!doctype html>\
<html>\
<head>\
  <meta charset="utf-8" />\
  <meta name="viewport" content="width=device-width, initial-scale=1" />\
  <title>Student Sign-Out</title>\
  <style>\
    html, body \{ height:100%; margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; background:#0b1220; color:#eef; \}\
    .wrap \{ display:flex; align-items:center; justify-content:center; height:100%; padding:16px; \}\
    .card \{ text-align:center; padding:32px; border-radius:16px; background:#111a2b; width:min(720px, 92vw); \}\
    .title \{ font-size:2rem; margin:0 0 8px; \}\
    .muted \{ opacity:.75; margin-bottom:8px; \}\
    .badge \{ margin-top:14px; display:none; padding:8px 12px; border-radius:10px; background:#1e2a42; \}\
    .hid \{ position:fixed; top:-9999px; left:-9999px; \}\
    .ok  \{ color:#a9d0ff; \}\
    .err \{ color:#ff9b9b; \}\
  </style>\
</head>\
<body>\
  <div class="wrap">\
    <div class="card">\
      <div class="title" id="name">Ready to scan\'85</div>\
      <div class="muted" id="hint">Scan barcode with the USB scanner</div>\
      <div class="badge" id="signed">Signed Out</div>\
      <div id="msg" style="margin-top:10px;"></div>\
    </div>\
  </div>\
\
  <input id="scanInput" class="hid" autocomplete="off" />\
  <script src="./config.js"></script>\
  <script>\
    const \{ API_BASE, SOURCE, DEVICE_ID, AUTO_CLEAR_MS \} = window.APP_CONFIG;\
    const scanInput = document.getElementById('scanInput');\
    const nameEl   = document.getElementById('name');\
    const signedEl = document.getElementById('signed');\
    const msgEl    = document.getElementById('msg');\
\
    let buf = '';\
    const focusInput = () => scanInput.focus();\
    ['click','focus','load'].forEach(ev => window.addEventListener(ev, focusInput));\
\
    window.addEventListener('keydown', (e)=>\{\
      if (e.key === 'Escape')\{ buf=''; clearCard(); return; \}\
      if (e.key === 'Enter')\{\
        const code = buf.trim(); buf = '';\
        if (code) submit(code);\
      \} else if (e.key.length === 1)\{\
        buf += e.key;\
      \}\
    \});\
\
    async function submit(barcode)\{\
      setCard('Scanning\'85', false, '');\
      try\{\
        const res = await fetch(`$\{API_BASE\}?route=scan`, \{\
          method:'POST',\
          headers:\{ 'Content-Type':'application/json' \},\
          body: JSON.stringify(\{ barcode, source: SOURCE, deviceId: DEVICE_ID \})\
        \});\
        const data = await res.json();\
        if (!data.ok) throw new Error(data.error || 'Scan failed');\
        const s = data.student || \{\};\
        const full = [s.FirstName, s.LastName].filter(Boolean).join(' ') || s.StudentID || 'Signed Out';\
        setCard(full, true, '');\
      \}catch(err)\{\
        setCard('Error', false, String(err));\
      \}finally\{\
        setTimeout(clearCard, AUTO_CLEAR_MS || 3000);\
      \}\
    \}\
\
    function setCard(title, showSigned, msg)\{\
      nameEl.textContent = title || '\'97';\
      signedEl.style.display = showSigned ? 'inline-block' : 'none';\
      msgEl.textContent = msg || '';\
      msgEl.className = msg ? 'err' : 'ok';\
    \}\
    function clearCard()\{ setCard('Ready to scan\'85', false, ''); focusInput(); \}\
  </script>\
</body>\
</html>\
}